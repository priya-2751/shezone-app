<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Child - SheZone</title>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Comfortaa:wght@700&display=swap');

    body {
      font-family: 'Comfortaa', cursive, Arial, sans-serif;
      background: linear-gradient(135deg, #ffe6f2, #ffb3d1);
      color: #7a1f4a;
      text-align: center;
      padding: 3rem 1.5rem;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      user-select: none;
    }

    h2 {
      font-size: 2.8rem;
      font-weight: 900;
      color: #d81e5b;
      margin-bottom: 2rem;
      letter-spacing: 0.1em;
      text-shadow: 1px 1px 4px rgba(216, 30, 91, 0.4);
      user-select: text;
    }

    button {
      background: linear-gradient(90deg, #d81e5b, #b02a6f);
      border: none;
      border-radius: 40px;
      padding: 1.2rem 3rem;
      font-size: 1.3rem;
      font-weight: 700;
      color: white;
      cursor: pointer;
      box-shadow: 0 8px 20px rgba(216, 30, 91, 0.4);
      transition: background 0.3s ease, transform 0.2s ease, box-shadow 0.3s ease;
      user-select: none;
    }

    button:hover:not(:disabled) {
      background: linear-gradient(90deg, #b02a6f, #d81e5b);
      transform: scale(1.05);
      box-shadow: 0 12px 30px rgba(216, 30, 91, 0.6);
    }

    button:active:not(:disabled) {
      transform: scale(0.95);
      box-shadow: 0 6px 15px rgba(216, 30, 91, 0.3);
    }

    button:disabled {
      background: #d9a6b8;
      cursor: not-allowed;
      box-shadow: none;
      color: #fff0f6;
    }

    .status {
      margin-top: 1.5rem;
      font-weight: 700;
      font-size: 1.1rem;
      color: #9c1d5d;
      min-height: 1.5em;
      user-select: text;
    }
  </style>
</head>
<body>
  <h2>Child - Share Live Location</h2>
  <button id="startBtn" aria-label="Start Sharing Location">Start Sharing Location</button>
  <div class="status" id="statusMsg"></div>

  <script>
    // ----- Firebase config -----
    const firebaseConfig = {
      apiKey: "AIzaSyCpd0NHTmbe1WTqdhK0Bw26xvrtRh05EoE",
      authDomain: "shezoneapp.firebaseapp.com",
      databaseURL:"https://shezoneapp-default-rtdb.firebaseio.com/",
      projectId: "shezoneapp",
      storageBucket: "shezoneapp.firebasestorage.app",
      messagingSenderId: "178639823528",
      appId: "1:178639823528:web:161605cc37dc724c7a589d",
      measurementId: "G-C8TP9HVVFZ"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const startBtn = document.getElementById('startBtn');
    const statusMsg = document.getElementById('statusMsg');
    let watchId = null;
    const childId = 'child1'; // Unique ID for this child

    startBtn.addEventListener('click', () => {
      if (!navigator.geolocation) {
        alert("Geolocation not supported!");
        return;
      }
      if (watchId) return;

      startBtn.disabled = true;
      startBtn.textContent = "Sharing...";

      watchId = navigator.geolocation.watchPosition(position => {
        const data = {
          lat: position.coords.latitude,
          lng: position.coords.longitude,
          timestamp: Date.now()
        };
        // Write location to Firebase
        db.ref(`children/${childId}`).set(data);
        statusMsg.textContent = `Location sent: (${data.lat.toFixed(5)}, ${data.lng.toFixed(5)})`;
      }, error => {
        statusMsg.textContent = `Error: ${error.message}`;
      }, { enableHighAccuracy: true, maximumAge: 5000, timeout: 10000 });
    });
  </script>
</body>
</html>
